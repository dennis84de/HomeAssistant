title: System
path: system
type: custom:horizontal-layout
layout:
  width: 400
  max_cols: 3        
cards:
  - type: entities
    title: Home Assistant
    show_header_toggle: false
    entities:
      - entity: sensor.database_size
      - entity: sensor.laufzeit_stunden
        name: Laufzeit
      - entity: sensor.hass_installierte_version
      - entity: sensor.hass_aktuelle_version
      - entity: sensor.hacs
      - entity: script.homeassistant_neustart
        name: Neustart

  - type: entities
    title: Benachrichtigungen
    show_header_toggle: false
    entities:          
      - entity: input_boolean.uhr_einschalten
      - entity: input_boolean.besuch
      - entity: input_boolean.nicht_stoeren  
      - entity: input_boolean.wetter_warnungen_einschalten

  - type: entities
    title: Radios
    show_header_toggle: false
    entities:   
      - entity: sensor.radios_eingeschaltet      
        tap_action:
          action: fire-dom-event
          browser_mod:
            service: browser_mod.popup
            data:              
              content:        
                type: entities
                entities:
                  - entity: switch.wohnzimmer_radio     
                    name: Wohnzimmer
                  - entity: switch.balkon_radio        
                    name: Balkon
                  - entity: switch.flur_radio        
                    name: Flur
                  - entity: switch.kueche_radio        
                    name: Küche
                  - entity: switch.badezimmer_radio        
                    name: Badezimmer          
                  - entity: switch.schlafzimmer_radio        
                    name: Schlafzimmer
                  - entity: switch.arbeitszimmer_radio
                    name: Arbeitszimmer                   
      - entity: switch.wiedergabe_aktiv
        tap_action:
          action: fire-dom-event
          browser_mod:
            service: browser_mod.popup
            data:              
              content:          
                type: entities
                entities:
                  - type: custom:mini-media-player
                    entity: media_player.radio_wohnzimmer
                    name: Wohnzimmer
                    hide:
                      source: true
                      progress: true
                      controls: true  
                      info: true
                  - type: custom:mini-media-player
                    entity: media_player.radio_balkon
                    name: Balkon    
                    hide:
                      source: true
                      progress: true
                      controls: true  
                      info: true         
                  - type: custom:mini-media-player
                    entity: media_player.radio_flur
                    name: Flur    
                    hide:
                      source: true
                      progress: true
                      controls: true  
                      info: true
                  - type: custom:mini-media-player
                    entity: media_player.radio_kueche
                    name: Küche    
                    hide:
                      source: true
                      progress: true
                      controls: true  
                      info: true         
                  - type: custom:mini-media-player
                    entity: media_player.radio_badezimmer
                    name: Badezimmer
                    hide:
                      source: true
                      progress: true
                      controls: true  
                      info: true            
                  - type: custom:mini-media-player
                    entity: media_player.radio_schlafzimmer
                    name: Schlafzimmer    
                    hide:
                      source: true
                      progress: true
                      controls: true  
                      info: true
                  - type: custom:mini-media-player
                    entity: media_player.radio_arbeitszimmer
                    name: Arbeitszimmer    
                    hide:
                      source: true
                      progress: true
                      controls: true  
                      info: true                        
      - entity: switch.radios_lautlos
      - entity: script.sync_radios
      - type: custom:mini-media-player
        entity: media_player.squeezebox
        name: Squeezebox
        hide:
          source: true
          progress: true
          controls: true  
          info: true
                    
  - type: glance
    title: Gäste Wlan
    show_header_toggle: false
    entities:
      - entity: switch.fritz_box_7272_wi_fi_pretty_fly_for_a_wifi
        name: Gastzugang
        tap_action:
           action: toggle
      - entity: sensor.gaeste_wlan_ssid
        name: SSID
      - entity: sensor.gaeste_wlan_password
        name: Passwort        

  - type: entities
    title: AdGuard
    show_header_toggle: false
    entities:
      - entity: switch.adguard_filtering
      - entity: sensor.adguard_dns_queries_blocked_ratio
      - entity: sensor.adguard_average_processing_speed

  - type: entities
    title: Backup
    show_header_toggle: false
    entities:
      - entity: sensor.samba_backup_status
      - entity: sensor.samba_letztes_backup

  - type: custom:stack-in-card
    title: Internet
    cards:
      - type: horizontal-stack
        cards:
          - type: sensor
            entity: sensor.speedtest_download
            name: Download
            hours_to_show: 24
            graph: line
            detail: 1
          - type: sensor
            entity: sensor.speedtest_upload
            name: Upload
            hours_to_show: 24
            graph: line
            detail: 1
        
  - type: entities
    title: Fritzbox
    show_header_toggle: false
    entities:
      - entity: sensor.fritz_box_7272_connection_uptime
        name: "Letzter Neustart"
      - entity: sensor.fritz_box_7272_external_ip
        name: Öffentliche IP
      - entity: sensor.fritz_box_7272_gb_received
        name: Daten empfangen
      - entity: sensor.fritz_box_7272_gb_sent
        name: Daten gesendet        
      - entity: sensor.heimnetz_offline                   

  - type: custom:auto-entities
    card:
      type: markdown
      title: Letzte Automationen
      show_header_toggle: false
      content: |
        {% for x in config.entities %}
          {%- set time = (as_timestamp(state_attr(x.entity, 'last_triggered')) | timestamp_custom('%H:%M')) -%}          
          {{ time }} &nbsp;&nbsp; {{ state_attr(x.entity, 'friendly_name') }}
        {% endfor %}    
    filter:
      include:
        - domain: automation
          last_triggered: '<= 1440'
      exclude:
        - attributes:
            last_triggered: null
    sort:
      method: last_triggered
      numeric: true
      reverse: true
      first: 0
      count: 20              
      
  - type: custom:auto-entities
    card:
      type: markdown
      title: Letzte Scripte
      show_header_toggle: false
      content: |
        {% for x in config.entities %}
          {%- set time = (as_timestamp(state_attr(x.entity, 'last_triggered')) | timestamp_custom('%H:%M')) -%}          
          {{ time }} &nbsp;&nbsp; {{ state_attr(x.entity, 'friendly_name') }}
        {% endfor %}
    filter:
      include:
        - domain: script
          last_triggered: '<= 1440'
      exclude:
        - attributes:
            last_triggered: null             
    sort:
      method: last_triggered
      numeric: true
      reverse: true
      first: 0
      count: 20    

  - type: entities
    title: Sonstiges
    show_header_toggle: false
    entities:          
      - entity: sensor.bewegungsmelder_deaktiviert
        tap_action:
          action: fire-dom-event
          browser_mod:
            service: browser_mod.popup
            data:              
              content:          
                type: entities
                entities:    
                  - entity: input_boolean.bewegungsmelder_wohnzimmer_deaktiviert
                    name: Wohnzimmer
                  - entity: input_boolean.bewegungsmelder_schlafzimmer_deaktiviert
                    name: Schlafzimmer
                  - entity: input_boolean.bewegungsmelder_kueche_deaktiviert
                    name: Küche
                  - entity: input_boolean.bewegungsmelder_badezimmer_deaktiviert
                    name: Badezimmer
                  - entity: input_boolean.bewegungsmelder_flur_deaktiviert
                    name: Flur
                  - entity: input_boolean.bewegungsmelder_arbeitszimmer_deaktiviert
                    name: Arbeitszimmer
                  - entity: input_boolean.bewegungsmelder_sportzimmer_deaktiviert
                    name: Sportzimmer  
                  - entity: input_boolean.bewegungsmelder_balkon_deaktiviert
                    name: Balkon                      
      - entity: script.alexa_witz_gestartet
        name: Witz erzählen      