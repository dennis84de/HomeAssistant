title: Geräte
path: geraete
type: custom:horizontal-layout
layout:
  width: 400
  max_cols: 3
cards:
  - type: entities
    title: Raspberry
    show_header_toggle: false
    entities:
      - entity: sensor.processor_temperature
      - entity: sensor.disk_use_percent
      - entity: sensor.memory_use_percent
      - entity: binary_sensor.rpi_power_status
      - entity: sensor.rpi_letzter_neustart

  - type: entities
    title: Computer
    show_header_toggle: false
    entities:
      - entity: sensor.computer_generic_hard_disk_load_used_space
      - entity: sensor.computer_wdc_wd20spzx_22ua7t0_load_used_space
      - entity: sensor.computer_wdc_wd20spzx_22ua7t0_temperatures_temperature
      - entity: sensor.computer_generic_memory_load_memory
      - entity: sensor.computer_intel_core_i5_8259u_load_cpu_total
      - entity: sensor.computer_intel_core_i5_8259u_temperatures_cpu_package

  - type: glance
    title: Hardware
    show_header_toggle: false
    entities:
      - entity: sensor.hardware_temperatur
      - entity: sensor.hardware_luftfeuchtigkeit
      - entity: sensor.hardware_luftdruck

  - type: entities
    title: Server
    show_header_toggle: false
    entities:
      - entity: binary_sensor.healthchecks_home_assistant  
      - entity: binary_sensor.healthchecks_diskstation        
      - entity: binary_sensor.uptime_robot_nextcloud        
      - entity: binary_sensor.healthchecks_djaeschke           

  - type: entities
    title: Nextcloud
    show_header_toggle: false
    entities:      
      - entity: sensor.nextcloud_zertifikat_tage
        name: Zertifikat
      - entity: sensor.nextcloud_system_version     
        name: Installierte Version

  - type: entities
    title: Zigbee
    show_header_toggle: false
    entities:
      - entity: zigate.zigate
      - entity: sensor.zigate_offline
      - entity: script.zigate_geraet_paaren

  - type: conditional
    view_layout:
      column: 2
    conditions:
      - entity: sensor.zigate_offline
        state_not: "0"
    card:
      type: markdown
      title: Zigate
      content: |
        {% if is_state('sensor.zigate_offline', '0') %}
          **<font color=#c5e566>Alle Geräte sind online</font>**
        {% else %}
          **<font color=#ff0000>Die folgenden Geräte sind offline:</font>**
          {% set puffer = states('input_number.zigate_offline_puffer') | int * 3600 | int -%}

          {% for state in (states.zigate
            | selectattr('attributes.last_seen')
            | sort(attribute='attributes.last_seen', reverse=false)) -%}
            {% if (as_timestamp(now()) - as_timestamp(state.state)) > puffer %}
              {%- set t = (as_timestamp(state.state) | timestamp_custom('%H:%M')) -%}
              {{t}} &nbsp;&nbsp; {{state.name}}
            {% endif -%}
          {% endfor %}             
        {% endif %}            

  - type: entities
    title: Bewegungsmelder
    show_header_toggle: false
    entities:
      - entity: zigate.bewegungsmelder_flur_vorne
        name: Flur vorne
      - entity: zigate.bewegungsmelder_flur_hinten
        name: Flur hinten
      - entity: zigate.bewegungsmelder_schlafzimmer
        name: Schlafzimmer
      - entity: zigate.bewegungsmelder_kueche
        name: Küche
      - entity: zigate.bewegungsmelder_arbeitszimmer
        name: Arbeitszimmer
      - entity: zigate.bewegungsmelder_sportzimmer
        name: Sportzimmer
      - entity: zigate.bewegungsmelder_bett
        name: Bett

  - type: entities
    title: Fenster
    show_header_toggle: false
    entities:
      - entity: zigate.balkontuer
        name: Balkontür      
      - entity: zigate.fenster_wohnzimmer
        name: Wohnzimmer
      - entity: zigate.fenster_schlafzimmer
        name: Schlafzimmer
      - entity: zigate.fenster_kueche
        name: Küche
      - entity: zigate.fenster_arbeitszimmer
        name: Arbeitszimmer
      - entity: zigate.fenster_sportzimmer
        name: Sportzimmer

  - type: entities
    title: Thermometer
    show_header_toggle: false
    entities:
      - entity: zigate.thermometer_balkon
        name: Balkon
      - entity: zigate.thermometer_parkplatz
        name: Parkplatz
      - entity: zigate.thermometer_flur
        name: Flur
      - entity: zigate.thermometer_schlafzimmer
        name: Schlafzimmer
      - entity: zigate.thermometer_arbeitszimmer
        name: Arbeitszimmer
      - entity: zigate.thermometer_sportzimmer
        name: Sportzimmer
      - entity: zigate.thermometer_kueche
        name: Küche
      - entity: zigate.thermometer_hardware
        name: Hardware  

  - type: entities
    title: Sensoren
    show_header_toggle: false
    entities:
      - entity: zigate.tuersensor      
      - entity: zigate.bett
      - entity: zigate.cube
      - entity: zigate.helligkeit_balkon
        name: Helligkeit
      
  - type: entities
    title: Schalter
    show_header_toggle: false
    entities:
      - entity: zigate.schalter_wohnzimmer
        name: Wohnzimmer
      - entity: zigate.schalter_schlafzimmer
        name: Schlafzimmer
      - entity: zigate.schalter_flur
        name: Flur
      - entity: zigate.schalter_arbeitszimmer
        name: Arbeitszimmer            
      - entity: zigate.schalter_badezimmer
        name: Badezimmer           
      - entity: zigate.schalter_balkon
        name: Balkon